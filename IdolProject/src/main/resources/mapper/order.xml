<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="OrderDAO">
  
  <select id="newGroupno" resultType="int">
  	<![CDATA[select nvl(max(order_group)+1,0+1) from order_product]]>
  </select>
  
  
  <insert id="addOrder" parameterType="OrderDTO">
  	<selectKey resultType="int" keyProperty="order_no" order="BEFORE">
  		<![CDATA[select nvl(max(ORDER_NO),0) from ORDER_PRODUCT]]>
  	</selectKey>
  	
		<![CDATA[insert into ORDER_PRODUCT values(#{order_no}+1, #{order_userid}, #{order_pimage},
		 		#{order_pname}, #{order_qty}, #{order_total}, #{order_tcost},
		 		#{order_mileage}, #{order_type},#{order_group}, sysdate, #{order_receivername}, #{order_receiveraddress},
		 		#{order_receiverphone},#{order_pprice}  )
		 		]]>  	
  </insert>
  
  <!-- 로그인중인 유저의 아이디를 인자로 받아 마지막 주문목록을 불러옴 -->
  <select id="lastorder" parameterType="String" resultType="OrderDTO">
  	<![CDATA[select *from order_product where order_group = (select max(order_group)from order_product) and order_userid = #{memid}]]>
  
  </select>
  
  
  
  
  
  
  </mapper>